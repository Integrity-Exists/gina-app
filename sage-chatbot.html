<!-- Sage Chatbot - Floating AI Companion -->
<style>
  #sageChatBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #2C3E50;
    color: white;
    padding: 12px 18px;
    border: none;
    border-radius: 50px;
    font-size: 16px;
    cursor: pointer;
    z-index: 1000;
  }

  #sageChatWindow {
    display: none;
    position: fixed;
    bottom: 80px;
    right: 20px;
    width: 300px;
    max-height: 400px;
    background: white;
    border: 2px solid #2C3E50;
    border-radius: 10px;
    z-index: 1001;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  #sageChatHeader {
    background-color: #2C3E50;
    color: white;
    padding: 10px;
    font-weight: bold;
  }

  #sageMessages {
    flex: 1;
    padding: 10px;
    overflow-y: auto;
    font-size: 14px;
  }

  #sageInputForm {
    display: flex;
    border-top: 1px solid #ccc;
  }

  #sageInput {
    flex: 1;
    padding: 8px;
    border: none;
    border-right: 1px solid #ccc;
  }

  #sageSendBtn {
    padding: 8px 10px;
    background-color: #2C3E50;
    color: white;
    border: none;
    cursor: pointer;
  }
</style>

<button id="sageChatBtn">ðŸ’¬ Ask Sage</button>

<div id="sageChatWindow">
  <div id="sageChatHeader">Sage - Legal AI Coach</div>
  <div id="sageMessages">
    <p><strong>Sage:</strong> Whatâ€™s going on? Hit me with your question.</p>
  </div>
  <form id="sageInputForm">
    <input type="text" id="sageInput" placeholder="Type your question..." />
    <button type="submit" id="sageSendBtn">Send</button>
  </form>
</div>

<script>
  const chatBtn = document.getElementById('sageChatBtn');
  const chatWindow = document.getElementById('sageChatWindow');
  const chatForm = document.getElementById('sageInputForm');
  const chatInput = document.getElementById('sageInput');
  const chatMsgs = document.getElementById('sageMessages');

  chatBtn.onclick = () => {
    chatWindow.style.display = (chatWindow.style.display === 'none') ? 'flex' : 'none';
  };

  chatForm.onsubmit = async (e) => {
    e.preventDefault();
    const userMsg = chatInput.value.trim();
    if (!userMsg) return;
    chatMsgs.innerHTML += `<p><strong>You:</strong> ${userMsg}</p>`;
    chatInput.value = '';

    // Simulated Sage reply (replace this with actual OpenAI API call if needed)
    setTimeout(() => {
      const reply = getSageReply(userMsg);
      chatMsgs.innerHTML += `<p><strong>Sage:</strong> ${reply}</p>`;
      chatMsgs.scrollTop = chatMsgs.scrollHeight;
    }, 600);
  };

  function getSageReply(msg) {
    // Placeholder: respond confidently like a legal street-smart coach
    if (msg.toLowerCase().includes("dss")) return "First thing, donâ€™t panic. Did they have a warrant or court order?";
    if (msg.toLowerCase().includes("eviction")) return "They can't just boot you. Letâ€™s talk lease, notice, and court papers.";
    if (msg.toLowerCase().includes("custody")) return "Youâ€™ve got rights â€” has there been a court order or just threats?";
    return "Letâ€™s break this down. Start with the facts and Iâ€™ll guide you from there.";
  }
</script>
